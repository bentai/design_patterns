# 命令模式 Command
### 1、定义
命令模式是一种行为型设计模式，它可将请求转换为一个包含与请求相关的所有信息的独立对象。
该转换让你能根据不同的请求将方法参数化、延迟请求执行或将其放入队列中，且能实现可撤销操作。

命令模式将请求封装成对象，以便使用不同的请求、队列或者日志来参数化其他对象

相当于把一系列的操作封装到命令中，当需要触发这一命令是，把这一命令绑定到发送者类中，这一命令实例化的同时需要绑定接收者

### 2、UML
![](https://qcdn.xueyuanjun.com/wp-content/uploads/2016/01/Command-Design-Pattern-UML.png)

### 3、 演示代码
```php
    interface CommandInterface
    {
        public function execute()
    }
    class HelloCommand implements CommandInterface
    {
        public $output;
        public function __construct(Receivr $console)
        {   
            $this->output = $console;
        }
        public function execute()
        {
            $this->output->write();
        }
    }
    // 发送者
    public function Invoker()
    {
        public $command;
        public function __construct(CommandInterface $command)
        {
            $this->command = $command;
        }
        public function run()
        {
            $this->command->execute();
        }
    }
    // 接收者 绑定到具体命令中
    class Receivr
    {
        public function write($str)
        {
            echo $str
        }
    }
    比如发送者是控制器，需要按下控制器按钮时执行一系列操作，比如开、关，假设控制器为电视机控制器，
    接收者就是电视机，将控制器上开的按钮绑定具体命令开上，这个具体命令开绑定的接收者是电视机，这样
    操作控制器开命令是就是对电视机执行一系列操作
```

### 4、应用场景
- 如果你需要通过操作来参数化对象，可使用命令模式
  + 命令模式可将特定的方法调用转化为独立对象。这一改变也带来了有趣的应用：你可以将命令作为方法的参数
    进行传递、将命令保存在其他对象中，或者在运行是切换已连接的命令等
- 如果你想要将操作放入队列中、操作的执行或者远程执行操作，可使用命令模式
  + 同其他对象一样，命令也可以实现序列化（序列化的意思是转化为字符串），从而能方便的写入文件或数据库中。
    一段时间后，该字符串可被恢复成最初的命令对象，因此，你可以延迟或计划命令的执行。但其功能远不止于此。
    使用同样的方式，你还可以将命令放入队列、记录命令或通过网络发送命令。
- 如果你想要实现操作回滚功能，可使用命令模式
  + 尽管有很多方法可以实现撤销和恢复功能，但命令模式可能是其中最常用的一个种。
    为了能够回滚操作，你需要实现已执行操作的历史记录功能。命令历史记录是一种包含所有已执行命令对象
    及其相关程序状态备份的栈结构。
  
### 5、优点
- 单一职责原则。你可以解耦触发和执行操作的类。
- 开闭原则。你可以在不修改已有客户端代码的情况下在程序中创建新的命令。
- 你可以实现撤销和恢复功能
- 你可以实现操作的延迟执行
- 你可以将一组简单命令组合成一个复杂命令
### 6、缺点
- 代码可能会变的更加复杂，因为你在发送者和接收者之间增加了一个全新的层次、
### 7、与其他模型的关系
- 命令和策略模式看上去很像，因为两者都是通过某些行为来参数化对象。但是，它们的意图有非常大的不同
    + 你可以使用命令来将任何操作转换成对象。操作的参数将成为对象的成员变量。你可以通过转换来延迟
      操作的执行、将操作放入队列、保存历史命令或者向远程服务发送命令等。
    + 另一方面，策略通常可用于描述完成某件事的不同方式，让你能够在同一个上下文类中切换算法
- 

